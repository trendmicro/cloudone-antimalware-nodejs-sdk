export const isJWT = (key: string): boolean => {
  try {
    const keySplitted = key.split('.')
    if (keySplitted.length !== 3) { // The JWT should contain three parts
      return false
    }
    const jsonFirstPart = Buffer.from(keySplitted[0], 'base64').toString('ascii')
    const firstPart = JSON.parse(jsonFirstPart) // The first part of JWT should be a JSON
    if (firstPart?.alg === undefined) { // The first part should have the attribute "alg"
      return false
    }
    return true
  } catch (error) {
    return false
  }
}
